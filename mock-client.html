<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document</title>
  <script src="https://cdn.socket.io/socket.io-1.3.7.js"></script>
</head>

<body>
  <script>
    const socket = io()
    const userId = prompt('Tell your name!', 'Clint Eastwood')
    const siteId = location.search.match(/id=(\d+)$/)[1]

    window.send = function (message) {
      socket.emit('update', {
          siteId,
          userId,
          message
      })
    }

    socket.on('connect', function () {
      socket.on('change', function (data) {
        console.log(`${data.userId}: ${data.message}`)
      })

      socket.on('enter', function(data) {
        console.log(`${data.userId} has joined`)
      })

      socket.emit('join', {
        userId,
        siteId
      })
    })


  </script>
</body>
</html>
